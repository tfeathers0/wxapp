<!-- dashboard.wxml -->
<view class="container">
   <!-- 状态相关图片 -->
  <image wx:if="{{currentPeriod === '月经期'}}" class="period-image" src="/images/menstrual_background.png"></image>
  <image wx:elif="{{currentPeriod === '卵泡期'}}" class="period-image" src="/images/follicular-background.png"></image>
  <image wx:elif="{{currentPeriod === '排卵期'}}" class="period-image" src="/images/ovulation_background.png"></image>
  <image wx:else class="period-image" src="/images/luteal_background.png"></image>
  
  <!-- 生理周期显示区域 -->
  <view class="cycle-section">
    
    <view class="cycle-header">
      <text class="cycle-title">生理周期</text>
    </view>
    
    <!-- 周期进度条 -->
    <view class="cycle-progress-container">
      <!-- 四段生理周期进度条 -->
      <view class="cycle-progress">
        <view class="cycle-segment segment-1"></view>
        <view class="cycle-segment segment-2"></view>
        <view class="cycle-segment segment-3"></view>
        <view class="cycle-segment segment-4"></view>
        
        <!-- 当前位置指示器 -->
         <view class="current-indicator" style="left: {{indicatorPosition}};"></view>
      </view>
      
      <!-- 生理周期标签 -->
      <view class="cycle-labels">
        <view class="cycle-label label-1">月经期</view>
        <view class="cycle-label label-2">卵泡期</view>
        <view class="cycle-label label-3">排卵期</view>
        <view class="cycle-label label-4">黄体期</view>
      </view>
    </view>
    
    <!-- 当前生理周期显示 -->
    <view class="current-cycle-display">
      <view class="cycle-indicator">
        <text class="indicator-text">当前处于</text>
        <text class="current-cycle-name">{{currentPeriod}}</text>
      </view>
    </view>
  </view>

  <!-- 信息展示区域 -->
  <view class="info-section">
    <view class="info-container">
      <!-- 左侧区域：日期卡片和关联切换 -->
      <view class="left-panel">
        <view class="date-card" bindtap="onDateCardClick">
          <image class="cal-icon" src="/images/calendar.png" mode="widthFix"></image>
            <text class="data-text">周期记录</text>
        </view>

        <!-- 关联切换按钮 -->
        <view class="switch-button" bindtap="onSwitchClick">
          <text class="switch-text">关联人</text>
        </view>
      </view>

      <!-- 右侧区域：知识卡片 -->
      <view class="right-panel">
        <!-- 知识卡片 -->
        <view class="knowledge-card" bindtap="onKnowledgeClick">
          <text class="knowledge-title">月伴小贴士</text>
          <view class="knowledge-content">
            <view class="knowledge-scroll-container">
              <view class="knowledge-scroll-wrapper" style="transform: translateY(-{{currentKnowledgeIndex * 160}}rpx);">
                <view class="knowledge-item">月经期子宫内膜脱落，形成经血排出。身体抵抗力较低。注意补充富含铁的食物（红肉、菠菜、动物血），喝温水，避免生冷辛辣；以休息或轻柔运动为主，如散步、瑜伽拉伸；及时更换卫生巾，保持私处清洁干燥。</view>
                <view class="knowledge-item">卵泡期在月经结束后，持续约一周左右，身体分泌激素促进卵子发育，子宫内膜增厚。身心状态逐渐回升。注意营养均衡，多补充蛋白质。适合进行高强度运动，如跑步、力量训练，效率高。</view>
                <view class="knowledge-item">排卵期在卵泡期结束后，一颗成熟卵子从卵巢排出，是最容易怀孕的时期。女性可能会有轻微腹痛，注意休息。</view>
                <view class="knowledge-item">黄体期在排卵后。激素水平变化可能导致经前综合征（PMS），如情绪波动、长痘、乳房胀痛等；容易食欲大增，可选择高纤维食物（蔬菜、粗粮）稳定血糖，减少盐分摄入以减轻水肿，保证充足睡眠，穿舒适的内衣。</view>
                <view class="knowledge-item">记得记录经期状态，预测下次月经和排卵日，更好地了解自己的身体规律。若痛经严重或周期极度不规律，请及时就医。</view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

<!-- Bottom tab-bar -->
<view class="tab-bar">
  <view class="tab-item" bindtap="switchToKnowledge">
    <image class="tab-icon" src="/images/知识库.png" mode="widthFix"></image>
  </view>
  
  <view class="tab-item" bindtap="switchToHome">
    <image class="tab-icon" src="/images/home.png" mode="widthFix"></image>
  </view>
  
  <view class="tab-item" bindtap="switchToMine">
    <image class="tab-icon" src="/images/me.png" mode="widthFix"></image>
  </view>
</view>


  <view wx:if="{{showPopup}}" class="popup-mask">
  <view class="popup-container">
    <button class="popup-close" bindtap="closePopup">✕</button>
    <view class="popup-content">
      <!-- 日期部分 - 使用较大粗体 -->
      <view class="popup-date-large">{{popupDateString}}</view>
      <view class="popup-weekday">{{popupWeekdayString}}</view>
      
      <!-- 消息内容部分 - 使用较小字体 -->
      <view class="popup-message">
        <text>{{popupMessage}}</text>
      </view>
    </view>
  </view>
</view>
</view>