<view class="info-container">
  <!-- 顶部信息区 -->
  <view class="header-section">
    <image class="avatar" src="{{contactInfo.avatar || '/images/avatar1.png'}}" mode="aspectFill"></image>
    <view class="user-info">
        <view class="nickname">{{contactInfo.nickname || contactInfo.username || '未命名'}}</view>
        <view class="relation">关系：{{contactInfo.relation || '朋友'}}</view>
      </view>
    <!-- 状态图标，只有当有状态查看权限时显示 -->
    <image wx:if="{{permissions.canViewStatus}}" class="state" src="{{contactInfo.state || '/images/icon_state_follicular.png'}}"></image>
  </view>

  <!-- 自定义日历板块，只有当有周期数据查看权限时显示 -->
  <view class="calendar-section" wx:if="{{permissions.canViewPassdays}}">
    <!-- 顶部月份切换 -->
    <view class="custom-calendar-header">
      <button class="month-btn" bindtap="prevMonth">上个月</button>
      <text>{{currentYear}}年 {{currentMonth+1}}月</text>
      <button class="month-btn" bindtap="nextMonth">下个月</button>
    </view>

    <!-- 星期标题 -->
    <view class="custom-calendar-week">
      <text>日</text>
      <text>一</text>
      <text>二</text>
      <text>三</text>
      <text>四</text>
      <text>五</text>
      <text>六</text>
    </view>

    <!-- 日期格子 -->
    <view class="custom-calendar-days">
      <block wx:for="{{days}}" wx:key="index">
        <view class="custom-calendar-day {{item.type}}" bindtap="onCustomCalendarDayTap" data-day="{{item.day}}" data-year="{{item.year}}" data-month="{{item.month}}">
          <text>{{item.day}}</text>
        </view>
      </block>
    </view>

    <!-- 图例 -->
    <view class="custom-calendar-legend">
      <view class="legend-item">
        <view class="dot ovulation"></view>
        <text>排卵日</text>
      </view>
      <view class="legend-item">
        <view class="dot period"></view>
        <text>生理期</text>
      </view>
    </view>
  </view>


 <!-- 授权信息区域 -->
 <view class="authorized-info">
    <view class="section-title">基本信息</view>
    <!-- 心情信息，只有当有心情查看权限时显示 -->
    <view wx:if="{{permissions.canViewMood}}" class="info-item">
      <view class="info-label">心情</view>
      <view class="info-value">{{contactInfo.mood || '未设置'}}</view>
    </view>
    <!-- 最近更新信息，不受权限控制，始终显示 -->
    <view class="info-item">
      <view class="info-label">最近更新</view>
      <view class="info-value">{{contactInfo.lastUpdate || '未知'}}</view>
    </view>
    <!-- 上次月经信息，只有当有月经时间查看权限时显示 -->
    <view wx:if="{{permissions.canViewMenstruation}}" class="info-item">
      <view class="info-label">上次月经</view>
      <view class="info-value">{{contactInfo.lastMenstruation || '暂无数据'}}</view>
    </view>
  </view>
  
  <!-- TIPs区域 -->
  <view class="tips-section">
    <view class="section-title">关怀提示</view>
    <!-- 状态提示信息，只有当有状态查看权限时显示 -->
    <view wx:if="{{permissions.canViewStatus}}" class="tip-item">
      <view class="tip-label">生理状态提示</view>
      <view class="tip-content">{{contactInfo.statusTip || '暂无状态提示信息'}}</view>
    </view>
    
    <!-- 心情提示信息，只有当同时有状态和心情查看权限时显示 -->
    <view wx:if="{{permissions.canViewStatus && permissions.canViewMood && contactInfo.moodTip}}" class="tip-item">
      <view class="tip-label">心情关怀建议</view>
      <view class="tip-content">{{contactInfo.moodTip}}</view>
    </view>
  </view>
  
  <!-- 底部占位元素，确保页面有足够的长度 -->
  <view class="bottom-placeholder"></view>

</view>
       